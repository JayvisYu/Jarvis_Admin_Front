{"remainingRequest":"/Users/jarvisyu/05_hobbies/Jarvis_Admin/frontend/vue-admin-template/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/jarvisyu/05_hobbies/Jarvis_Admin/frontend/vue-admin-template/src/components/HeaderSearch/index.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/jarvisyu/05_hobbies/Jarvis_Admin/frontend/vue-admin-template/src/components/HeaderSearch/index.vue","mtime":1626619590873},{"path":"/Users/jarvisyu/05_hobbies/Jarvis_Admin/frontend/vue-admin-template/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jarvisyu/05_hobbies/Jarvis_Admin/frontend/vue-admin-template/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/jarvisyu/05_hobbies/Jarvis_Admin/frontend/vue-admin-template/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/jarvisyu/05_hobbies/Jarvis_Admin/frontend/vue-admin-template/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCi8vIGZ1c2UgaXMgYSBsaWdodHdlaWdodCBmdXp6eS1zZWFyY2ggbW9kdWxlCi8vIG1ha2Ugc2VhcmNoIHJlc3VsdHMgbW9yZSBpbiBsaW5lIHdpdGggZXhwZWN0YXRpb25zCmltcG9ydCBGdXNlIGZyb20gJ2Z1c2UuanMnCmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnCgpleHBvcnQgZGVmYXVsdCB7CgluYW1lOiAnSGVhZGVyU2VhcmNoJywKCWRhdGEgKCkgewoJCXJldHVybiB7CgkJCXNlYXJjaDogJycsCgkJCW9wdGlvbnM6IFtdLAoJCQlzZWFyY2hQb29sOiBbXSwKCQkJc2hvdzogZmFsc2UsCgkJCWZ1c2U6IHVuZGVmaW5lZAoJCX0KCX0sCgljb21wdXRlZDogewoJCXJvdXRlcyAoKSB7CgkJCXJldHVybiB0aGlzLiRzdG9yZS5nZXR0ZXJzLnBlcm1pc3Npb25fcm91dGVzCgkJfQoJfSwKCXdhdGNoOiB7CgkJcm91dGVzICgpIHsKCQkJdGhpcy5zZWFyY2hQb29sID0gdGhpcy5nZW5lcmF0ZVJvdXRlcyh0aGlzLnJvdXRlcykKCQl9LAoJCXNlYXJjaFBvb2wgKGxpc3QpIHsKCQkJdGhpcy5pbml0RnVzZShsaXN0KQoJCX0sCgkJc2hvdyAodmFsdWUpIHsKCQkJaWYgKHZhbHVlKSB7CgkJCQlkb2N1bWVudC5ib2R5LmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgdGhpcy5jbG9zZSkKCQkJfSBlbHNlIHsKCQkJCWRvY3VtZW50LmJvZHkucmVtb3ZlRXZlbnRMaXN0ZW5lcignY2xpY2snLCB0aGlzLmNsb3NlKQoJCQl9CgkJfQoJfSwKCW1vdW50ZWQgKCkgewoJCXRoaXMuc2VhcmNoUG9vbCA9IHRoaXMuZ2VuZXJhdGVSb3V0ZXModGhpcy5yb3V0ZXMpCgl9LAoJbWV0aG9kczogewoJCWNsaWNrICgpIHsKCQkJdGhpcy5zaG93ID0gIXRoaXMuc2hvdwoJCQlpZiAodGhpcy5zaG93KSB7CgkJCQl0aGlzLiRyZWZzLmhlYWRlclNlYXJjaFNlbGVjdCAmJiB0aGlzLiRyZWZzLmhlYWRlclNlYXJjaFNlbGVjdC5mb2N1cygpCgkJCX0KCQl9LAoJCWNsb3NlICgpIHsKCQkJdGhpcy4kcmVmcy5oZWFkZXJTZWFyY2hTZWxlY3QgJiYgdGhpcy4kcmVmcy5oZWFkZXJTZWFyY2hTZWxlY3QuYmx1cigpCgkJCXRoaXMub3B0aW9ucyA9IFtdCgkJCXRoaXMuc2hvdyA9IGZhbHNlCgkJfSwKCQljaGFuZ2UgKHZhbCkgewoJCQl0aGlzLiRyb3V0ZXIucHVzaCh2YWwucGF0aCkKCQkJdGhpcy5zZWFyY2ggPSAnJwoJCQl0aGlzLm9wdGlvbnMgPSBbXQoJCQl0aGlzLiRuZXh0VGljaygoKSA9PiB7CgkJCQl0aGlzLnNob3cgPSBmYWxzZQoJCQl9KQoJCX0sCgkJaW5pdEZ1c2UgKGxpc3QpIHsKCQkJdGhpcy5mdXNlID0gbmV3IEZ1c2UobGlzdCwgewoJCQkJc2hvdWxkU29ydDogdHJ1ZSwKCQkJCXRocmVzaG9sZDogMC40LAoJCQkJbG9jYXRpb246IDAsCgkJCQlkaXN0YW5jZTogMTAwLAoJCQkJbWF4UGF0dGVybkxlbmd0aDogMzIsCgkJCQltaW5NYXRjaENoYXJMZW5ndGg6IDEsCgkJCQlrZXlzOiBbewoJCQkJCW5hbWU6ICd0aXRsZScsCgkJCQkJd2VpZ2h0OiAwLjcKCQkJCX0sIHsKCQkJCQluYW1lOiAncGF0aCcsCgkJCQkJd2VpZ2h0OiAwLjMKCQkJCX1dCgkJCX0pCgkJfSwKCQkvLyBGaWx0ZXIgb3V0IHRoZSByb3V0ZXMgdGhhdCBjYW4gYmUgZGlzcGxheWVkIGluIHRoZSBzaWRlYmFyCgkJLy8gQW5kIGdlbmVyYXRlIHRoZSBpbnRlcm5hdGlvbmFsaXplZCB0aXRsZQoJCWdlbmVyYXRlUm91dGVzIChyb3V0ZXMsIGJhc2VQYXRoID0gJy8nLCBwcmVmaXhUaXRsZSA9IFtdKSB7CgkJCWxldCByZXMgPSBbXQoKCQkJZm9yIChjb25zdCByb3V0ZXIgb2Ygcm91dGVzKSB7CgkJCQkvLyBza2lwIGhpZGRlbiByb3V0ZXIKCQkJCWlmIChyb3V0ZXIuaGlkZGVuKSB7IGNvbnRpbnVlIH0KCgkJCQljb25zdCBkYXRhID0gewoJCQkJCXBhdGg6IHBhdGgucmVzb2x2ZShiYXNlUGF0aCwgcm91dGVyLnBhdGgpLAoJCQkJCXRpdGxlOiBbLi4ucHJlZml4VGl0bGVdCgkJCQl9CgoJCQkJaWYgKHJvdXRlci5tZXRhICYmIHJvdXRlci5tZXRhLnRpdGxlKSB7CgkJCQkJZGF0YS50aXRsZSA9IFsuLi5kYXRhLnRpdGxlLCByb3V0ZXIubWV0YS50aXRsZV0KCgkJCQkJaWYgKHJvdXRlci5yZWRpcmVjdCAhPT0gJ25vUmVkaXJlY3QnKSB7CgkJCQkJCS8vIG9ubHkgcHVzaCB0aGUgcm91dGVzIHdpdGggdGl0bGUKCQkJCQkJLy8gc3BlY2lhbCBjYXNlOiBuZWVkIHRvIGV4Y2x1ZGUgcGFyZW50IHJvdXRlciB3aXRob3V0IHJlZGlyZWN0CgkJCQkJCXJlcy5wdXNoKGRhdGEpCgkJCQkJfQoJCQkJfQoKCQkJCS8vIHJlY3Vyc2l2ZSBjaGlsZCByb3V0ZXMKCQkJCWlmIChyb3V0ZXIuY2hpbGRyZW4pIHsKCQkJCQljb25zdCB0ZW1wUm91dGVzID0gdGhpcy5nZW5lcmF0ZVJvdXRlcyhyb3V0ZXIuY2hpbGRyZW4sIGRhdGEucGF0aCwgZGF0YS50aXRsZSkKCQkJCQlpZiAodGVtcFJvdXRlcy5sZW5ndGggPj0gMSkgewoJCQkJCQlyZXMgPSBbLi4ucmVzLCAuLi50ZW1wUm91dGVzXQoJCQkJCX0KCQkJCX0KCQkJfQoJCQlyZXR1cm4gcmVzCgkJfSwKCQlxdWVyeVNlYXJjaCAocXVlcnkpIHsKCQkJaWYgKHF1ZXJ5ICE9PSAnJykgewoJCQkJdGhpcy5vcHRpb25zID0gdGhpcy5mdXNlLnNlYXJjaChxdWVyeSkKCQkJfSBlbHNlIHsKCQkJCXRoaXMub3B0aW9ucyA9IFtdCgkJCX0KCQl9Cgl9Cn0K"},{"version":3,"sources":["index.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAgCA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"index.vue","sourceRoot":"src/components/HeaderSearch","sourcesContent":["<template>\n\t<div\n\t\t:class=\"{'show':show}\"\n\t\tclass=\"header-search\"\n\t>\n\t\t<svg-icon\n\t\t\tclass-name=\"search-icon\"\n\t\t\ticon-class=\"search\"\n\t\t\t@click.stop=\"click\"\n\t\t/>\n\t\t<el-select\n\t\t\tref=\"headerSearchSelect\"\n\t\t\tv-model=\"search\"\n\t\t\t:remote-method=\"querySearch\"\n\t\t\tfilterable\n\t\t\tdefault-first-option\n\t\t\tremote\n\t\t\tplaceholder=\"Search\"\n\t\t\tclass=\"header-search-select\"\n\t\t\t@change=\"change\"\n\t\t>\n\t\t\t<el-option\n\t\t\t\tv-for=\"item in options\"\n\t\t\t\t:key=\"item.path\"\n\t\t\t\t:value=\"item\"\n\t\t\t\t:label=\"item.title.join(' > ')\"\n\t\t\t/>\n\t\t</el-select>\n\t</div>\n</template>\n\n<script>\n// fuse is a lightweight fuzzy-search module\n// make search results more in line with expectations\nimport Fuse from 'fuse.js'\nimport path from 'path'\n\nexport default {\n\tname: 'HeaderSearch',\n\tdata () {\n\t\treturn {\n\t\t\tsearch: '',\n\t\t\toptions: [],\n\t\t\tsearchPool: [],\n\t\t\tshow: false,\n\t\t\tfuse: undefined\n\t\t}\n\t},\n\tcomputed: {\n\t\troutes () {\n\t\t\treturn this.$store.getters.permission_routes\n\t\t}\n\t},\n\twatch: {\n\t\troutes () {\n\t\t\tthis.searchPool = this.generateRoutes(this.routes)\n\t\t},\n\t\tsearchPool (list) {\n\t\t\tthis.initFuse(list)\n\t\t},\n\t\tshow (value) {\n\t\t\tif (value) {\n\t\t\t\tdocument.body.addEventListener('click', this.close)\n\t\t\t} else {\n\t\t\t\tdocument.body.removeEventListener('click', this.close)\n\t\t\t}\n\t\t}\n\t},\n\tmounted () {\n\t\tthis.searchPool = this.generateRoutes(this.routes)\n\t},\n\tmethods: {\n\t\tclick () {\n\t\t\tthis.show = !this.show\n\t\t\tif (this.show) {\n\t\t\t\tthis.$refs.headerSearchSelect && this.$refs.headerSearchSelect.focus()\n\t\t\t}\n\t\t},\n\t\tclose () {\n\t\t\tthis.$refs.headerSearchSelect && this.$refs.headerSearchSelect.blur()\n\t\t\tthis.options = []\n\t\t\tthis.show = false\n\t\t},\n\t\tchange (val) {\n\t\t\tthis.$router.push(val.path)\n\t\t\tthis.search = ''\n\t\t\tthis.options = []\n\t\t\tthis.$nextTick(() => {\n\t\t\t\tthis.show = false\n\t\t\t})\n\t\t},\n\t\tinitFuse (list) {\n\t\t\tthis.fuse = new Fuse(list, {\n\t\t\t\tshouldSort: true,\n\t\t\t\tthreshold: 0.4,\n\t\t\t\tlocation: 0,\n\t\t\t\tdistance: 100,\n\t\t\t\tmaxPatternLength: 32,\n\t\t\t\tminMatchCharLength: 1,\n\t\t\t\tkeys: [{\n\t\t\t\t\tname: 'title',\n\t\t\t\t\tweight: 0.7\n\t\t\t\t}, {\n\t\t\t\t\tname: 'path',\n\t\t\t\t\tweight: 0.3\n\t\t\t\t}]\n\t\t\t})\n\t\t},\n\t\t// Filter out the routes that can be displayed in the sidebar\n\t\t// And generate the internationalized title\n\t\tgenerateRoutes (routes, basePath = '/', prefixTitle = []) {\n\t\t\tlet res = []\n\n\t\t\tfor (const router of routes) {\n\t\t\t\t// skip hidden router\n\t\t\t\tif (router.hidden) { continue }\n\n\t\t\t\tconst data = {\n\t\t\t\t\tpath: path.resolve(basePath, router.path),\n\t\t\t\t\ttitle: [...prefixTitle]\n\t\t\t\t}\n\n\t\t\t\tif (router.meta && router.meta.title) {\n\t\t\t\t\tdata.title = [...data.title, router.meta.title]\n\n\t\t\t\t\tif (router.redirect !== 'noRedirect') {\n\t\t\t\t\t\t// only push the routes with title\n\t\t\t\t\t\t// special case: need to exclude parent router without redirect\n\t\t\t\t\t\tres.push(data)\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// recursive child routes\n\t\t\t\tif (router.children) {\n\t\t\t\t\tconst tempRoutes = this.generateRoutes(router.children, data.path, data.title)\n\t\t\t\t\tif (tempRoutes.length >= 1) {\n\t\t\t\t\t\tres = [...res, ...tempRoutes]\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn res\n\t\t},\n\t\tquerySearch (query) {\n\t\t\tif (query !== '') {\n\t\t\t\tthis.options = this.fuse.search(query)\n\t\t\t} else {\n\t\t\t\tthis.options = []\n\t\t\t}\n\t\t}\n\t}\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.header-search {\n\tfont-size: 0 !important;\n\n\t.search-icon {\n\t\tcursor: pointer;\n\t\tfont-size: 18px;\n\t\tvertical-align: middle;\n\t}\n\n\t.header-search-select {\n\t\tfont-size: 18px;\n\t\ttransition: width 0.2s;\n\t\twidth: 0;\n\t\toverflow: hidden;\n\t\tbackground: transparent;\n\t\tborder-radius: 0;\n\t\tdisplay: inline-block;\n\t\tvertical-align: middle;\n\n\t\t::v-deep .el-input__inner {\n\t\t\tborder-radius: 0;\n\t\t\tborder: 0;\n\t\t\tpadding-left: 0;\n\t\t\tpadding-right: 0;\n\t\t\tbox-shadow: none !important;\n\t\t\tborder-bottom: 1px solid #d9d9d9;\n\t\t\tvertical-align: middle;\n\t\t}\n\t}\n\n\t&.show {\n\t\t.header-search-select {\n\t\t\twidth: 210px;\n\t\t\tmargin-left: 10px;\n\t\t}\n\t}\n}\n</style>\n"]}]}